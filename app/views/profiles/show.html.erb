<%if @profile.avatar.attached?%>
  <%= image_tag @profile.avatar, class:"size-35 rounded-full shadow-lg"%>
<%else%>
  <img src="<%= image_path('default.jpg') %>" alt="default profile picture", class = "size-25 rounded-full shadow-lg">
<%end%>
<h1><%if @profile.full_name%>
    <%=@profile.full_name%>'s profile
  <%else%>
    Anonymoys profile
  <%end%>
</h1>
<div><%=link_to "Edit profile", edit_profile_path(@profile) if current_user == @profile.user%></div>
<%if FolloweesFollower.exists?(follower_id: current_user.id, followee_id: @profile.user.id)%>
  <%= button_to 'Unfollow', followees_follower_path(follower_id: current_user.id, followee_id: @profile.user.id), method: :delete %>
<%end%>
<%if current_user == @profile.user && current_user.pending_requests.pending.any?%>
  <ul>You have friend requests by: 
    <%current_user.pending_requests.pending.each do |request|%>
      <li>
        <%="#{request.requester.profile.full_name}"%>
        <%= render partial: "shared/accept_form", locals: { request: request } %>
        <%= render partial: "shared/reject_form", locals: { request: request } %>
      </li>
    <%end%>
  </ul>
<%end%>
<%unless current_user.id == @profile.user.id || FollowRequest.exists?(requester_id: current_user.id, approver_id: @profile.user.id) %>
  <%= render partial: "shared/request_form", locals: { follow_request_form: @follow_request } %>
<%end%>
<br>
<br>
<h3>Latest posts</h3>
<br>
<br>
<div>
  <% @profile.user.posts.each do |post|%>
    <%= render partial: "shared/post", locals: { post: post } %>
  <%end%>
</div>
<div><%= link_to "Back", root_path%>
</div>
